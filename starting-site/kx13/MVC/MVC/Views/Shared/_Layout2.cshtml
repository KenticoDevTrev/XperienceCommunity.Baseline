@{
    Layout = null;
    // This Layout leverages the Baseline "Async Script" system which offloads all javascript till after page load, but requires special care when building out your javascript logic.
}

<!DOCTYPE html>
<html dir="ltr" lang="@(System.Threading.Thread.CurrentThread.CurrentCulture.Name.Split('-')[0])">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    @* window.OnScriptsLoaded = All javascript that depends on any library should use window.OnScriptsLoaded(function() { }, identifier) so it will run after the javascript is loaded, identifier is optional to ensure only ran once *@
    @* window.LoadScript = Loading javascript, should be window.LoadScript({src: string, header?: boolean, crossorigin?: string, appendAtEnd?: bool}) *@
    <cache enabled=true expires-after="@CacheMinuteTypes.VeryLong.ToTimeSpan()">
        <vc:async-script-functions />
    </cache>

    <environment exclude="Development">
        @* Defined in gulpfile.js headerCss *@
        <link href="/css/shared/bundles/HeaderStyles.min.css.gz" rel="preload" as="style" asp-append-version="true" />
    </environment>

    <link rel="stylesheet" href="/css/shared/bootstrap.min.css.gz" asp-append-version="true" />

    <environment exclude="Development">
        @* Defined in gulpfile.js headerCss *@
        <link href="/css/shared/bundles/HeaderStyles.min.css.gz" rel="stylesheet" asp-append-version="true" />

        @* start preloading javascript *@
        <!--<link href="@(Html.AddFileVersionToPath("/js/shared/bundles/bundleJSFooter.min.js.gz"))" rel="preload" as="script" />-->
    </environment>


    @RenderSection("head", required: false)
    @* added after so if there is any manual meta data that below won't trigger even if there is a matching page on the content tree *@
    <vc:page-meta-data />

    <page-builder-mode include="Edit">
        <!-- Edit Mode -->
        <page-builder-styles />
        <link href="/css/EditMode.css" rel="stylesheet" />
    </page-builder-mode>

</head>
<body>
    <cache expires-after="CacheMinuteTypes.VeryLong.ToTimeSpan()">
        @{
            CacheScope.Begin();
        }
        <!--<vc:ada-quick-nav />-->
        <cache-dependency cache-keys="@CacheScope.End()" />
    </cache>


    <header data-ktc-search-exclude>
    </header>

    @RenderSection("breadcrumb", false)

    @RenderBody()

    <footer data-ktc-search-exclude>
    </footer>

    <page-builder-mode include="Edit">
        <!-- Edit mode-->
        <page-builder-scripts />
        <script src="/js/shared/scripts/MyComponentsConfiguration.js"></script>
    </page-builder-mode>

    <page-builder-mode exclude="Edit">
        @* These will be automatically called in the header in Edit Mode, so only need to be called when not in edit mode *@
        <script>LoadScript({ src: "@(Html.AddFileVersionToPath("/js/shared/jquery/jquery.min.js.gz"))" })</script>
        <script>LoadScript({ src: "@(Html.AddFileVersionToPath("/js/shared/jquery.unobtrusive.ajax/jquery.unobtrusive-ajax.min.js.gz"))" })</script>
        @* These are needed for Forms, edit mode includes these as well so only need when not in edit mode *@
        <script>LoadScript({ src: "@(Html.AddFileVersionToPath("/js/shared/scripts/updatableFormHelper.min.js.gz"))" })</script>
        <script>LoadScript({ src: "@(Html.AddFileVersionToPath("/js/shared/scripts/inputmask.min.js.gz"))" })</script>
    </page-builder-mode>

    <!-- Javascripts File -->
    <environment exclude="Development">
        @* Defined in gulpfile.js footerJS *@
        <script>LoadScript({ src: "@(Html.AddFileVersionToPath("/js/shared/bundles/bundleJSFooter.min.js.gz"))" })</script>
    </environment>
    <environment include="Development">
        @* Defined in gulpfile.js footerJS *@
        @* Bootstrap js is found in the plugins.min.js *@
        <!--<script>LoadScript({ src: "/js/shared/generated/plugins.min.js" })</script>-->
    </environment>

    <!-- Includes the jQuery Validator for MVC-->
    <script>LoadScript({ src: "@(Html.AddFileVersionToPath("/js/shared/jquery.validate/jquery.validate.min.js.gz"))" })</script>
    <script type="text/javascript">
        OnScriptsLoaded(function () {
            $.validator.setDefaults({ ignore: null });
        });
    </script>

    @RenderSection("bottom", required: false)

    <vc:page-html-tags location="Startup" />

    <script>
        OnScriptsLoaded(function () {
            @*
                These are to initialize various functionality pieces
            GlobalMethods.InitializeOtherTools();
            GlobalMethods.InitializeAccessability();
            GlobalMethods.InitializeCanvas();
            GlobalMethods.InitializeRedirectTabs();
                *@
        });
    </script>

    <cache enabled=true expires-after="@CacheMinuteTypes.VeryLong.ToTimeSpan()">
        @* This will run last after all scripts loaded, and will run the Preload methods
            Content should be:

            window.ScriptsLoaded = true;
            for (var queuedScripts = window.PreloadQueue || [], i = 0; i < queuedScripts.length; i++)
            queuedScripts[i]();
        *@
        <vc:async-script-loader x-script-runner-path="@(Html.AddFileVersionToPath("/js/individual/scripts/run-queued-scripts.min.js.gz"))" />
    </cache>
</body>
</html>
